"use strict";var _setSpinnerSize=function(){$("#za_catalog_cart_table_spinner").width($("#za_catalog_cart_table").width()).height($("#za_catalog_cart_table").height())},_debounce=function(t,a){var e=null;return function(){var r=this,n=arguments;clearTimeout(e),e=setTimeout(function(){t.apply(r,n)},a)}};$(document).ready(function(){_setSpinnerSize(),$(".za-catalog-cart-count").keyup(_debounce(function(){var t=$(this).val().trim();if($(this).removeClass("za-form-danger"),!t.match(/^[0-9]+$/)||t.length>5)return $(this).addClass("za-form-danger");var a=this;t!==$(a).attr("data-prev")&&($(a).attr("data-prev",t),_setSpinnerSize(),$("#za_catalog_cart_table_spinner").show(),$.ajax({type:"POST",url:"/api/warehouse/cart/count",data:{id:$(a).attr("data"),variant:$(a).attr("data-variant"),count:t},cache:!1}).done(function(e){if(setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),1!==e.status)$(a).addClass("za-form-danger");else{e.count!==t&&$(a).val(e.count),$('.za-catalog-cart-subtotal[data="'+e.id+'"][data-variant="'+e.variant+'"]').html("right"===currencyPosition?e.subtotal+"&nbsp;"+settings.currency:settings.currency+e.subtotal).attr("data-val",e.subtotal);var r=0;$(".za-catalog-cart-subtotal").each(function(){r+=parseFloat($(this).attr("data-val"))}),$(".za-catalog-cart-total").html("right"===currencyPosition?parseFloat(r).toFixed(2)+"&nbsp;"+settings.currency:settings.currency+parseFloat(r).toFixed(2))}}).fail(function(){setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),$(a).addClass("za-form-danger")}))},250)),$(".za-catalog-cart-btn-del").click(function(){var t=this;$("#za_catalog_cart_table_spinner").show(),$.ajax({type:"POST",url:"/api/warehouse/cart/delete",data:{id:$(t).attr("data"),variant:$(t).attr("data-variant")},cache:!1}).done(function(a){if(setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),1===a.status){$(t).parent().parent().remove(),0===$("#za_catalog_cart_table>tbody").children().length&&($("#za_catalog_cart_wrap").hide(),$("#za_catalog_cart_empty").show());var e=0;$(".za-catalog-cart-subtotal").each(function(){e+=parseFloat($(this).attr("data-val"))}),$(".za-catalog-cart-total").html("right"===currencyPosition?parseFloat(e).toFixed(2)+"&nbsp;"+settings.currency:settings.currency+parseFloat(e).toFixed(2))}else $zUI.notification(lang["Could not delete item from your cart"],{status:"danger",timeout:1e3})}).fail(function(){setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),$zUI.notification(lang["Could not delete item from your cart"],{status:"danger",timeout:1e3})})})});