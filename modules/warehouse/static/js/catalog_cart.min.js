"use strict";var _setSpinnerSize=function(){$("#za_catalog_cart_table_spinner").width($("#za_catalog_cart_table").width()).height($("#za_catalog_cart_table").height())},_debounce=function(a,t){var e=null;return function(){var n=this,r=arguments;clearTimeout(e),e=setTimeout(function(){a.apply(n,r)},t)}};$(document).ready(function(){_setSpinnerSize(),$(".za-catalog-cart-count").keyup(_debounce(function(){var a=$(this).val().trim();if($(this).removeClass("za-form-danger"),!a.match(/^[0-9]+$/)||a.length>5)return $(this).addClass("za-form-danger");var t=this;a!==$(t).attr("data-prev")&&($(t).attr("data-prev",a),_setSpinnerSize(),$("#za_catalog_cart_table_spinner").show(),$.ajax({type:"POST",url:"/api/warehouse/cart/count",data:{id:$(t).attr("data"),variant:$(t).attr("data-variant"),count:a},cache:!1}).done(function(e){if(setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),1!==e.status)$(t).addClass("za-form-danger");else{e.count!==a&&$(t).val(e.count),$('.za-catalog-cart-subtotal[data="'+e.id+'"][data-variant="'+e.variant+'"]').html(e.subtotal+"&nbsp;"+settings.currency).attr("data-val",e.subtotal);var n=0;$(".za-catalog-cart-subtotal").each(function(){n+=parseFloat($(this).attr("data-val"))}),$(".za-catalog-cart-total").html(parseFloat(n).toFixed(2)+"&nbsp;"+settings.currency)}}).fail(function(){setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),$(t).addClass("za-form-danger")}))},250)),$(".za-catalog-cart-btn-del").click(function(){var a=this;$("#za_catalog_cart_table_spinner").show(),$.ajax({type:"POST",url:"/api/warehouse/cart/delete",data:{id:$(a).attr("data"),variant:$(a).attr("data-variant")},cache:!1}).done(function(t){if(setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),1===t.status){$(a).parent().parent().remove(),0===$("#za_catalog_cart_table>tbody").children().length&&($("#za_catalog_cart_wrap").hide(),$("#za_catalog_cart_empty").show());var e=0;$(".za-catalog-cart-subtotal").each(function(){e+=parseFloat($(this).attr("data-val"))}),$(".za-catalog-cart-total").html(parseFloat(e).toFixed(2)+"&nbsp;"+settings.currency)}else $zUI.notification(lang["Could not delete item from your cart"],{status:"danger",timeout:1e3})}).fail(function(){setTimeout(function(){$("#za_catalog_cart_table_spinner").hide()},300),$zUI.notification(lang["Could not delete item from your cart"],{status:"danger",timeout:1e3})})})});